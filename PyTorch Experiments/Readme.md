# PyTorch Experiments

## Baseline Model

Исходной моделью здесь будем считать результат [экспериментов в тензорфлоу](https://github.com/FortsAndMills/MusicGeneration/tree/master/RealData%20First%20Model), а именно:
* сжатие в 12-мерное представление и последующее декодирование обычным однослойным LSTM-ом с предположением о независимости ответа для всех клавиш при декодировке.
* схема 100-100 HistoryUser для дополнительного использования истории
* полученные высокоуровневые фичи отправляются в полифонический сэмплер, который работает по следующему принципу:
    * является однослойным LSTM-ом.
    * выдаёт 24 вероятности, интерпретируемых как категориальное распределение на следующем домене: 12 исходов "нота звучит" и 12 исходов "нота точно не звучит".
    * сэмплер генерирует это распределение, из него происходит сэмплирование, результат подаётся сэмплеру на вход и он снова генерирует распределение; и так 5 раз.
    * на выходе LSTM-а вероятности засэмплировать исход, относящейся к ноте, по которой решение уже принято, насильно зануляются. Таким образом, по каждой ноте принимается одно окончательное решение.
    * обучение происходит по no aposter схеме, а именно: если при обучении сэмплируется по некоторой ноте неверное решение, оно инвертируется. Таким образом, при обучении каждый "голос" получает на вход только верную информацию.
    * вероятности, выданные всеми 5 голосами, с учётом занулений, используются для вычислений следующих вероятностей:
        * вероятность того, что нота будет забанена b = b1 + (1 - b1)b2 + (1 - b1)(1 - b2)b3 + ...
        * вероятность того, что нота будет звучать p = p1 + (1 - p1)p2 + (1 - p1)(1 - p2)p3 + ...
    * тогда вероятность того, что будет сгенерирована 1 для i-ой ноты, равна p(1 - b).
    * минимизируется кросс-энтропия.
    
Реализация: PyTorch Baseline Model.
Модель для CP датасета: Baseline.pt, Baseline Decoder.pt

### Исследуемые вопросы:
* Можно ли заменить декодер на Decoder RBM?
* Можно ли генерировать громкость нот?
* Можно ли улучшить attention (т.е. HistoryUser-схему), заменив её на, например, иерархическую сеть?
* Станет ли лучше при замене представления с текущего 1 = нота нажимается на 1 = нота звучит?
